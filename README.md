# NexusWAF System

Cистема защиты веб-приложений с веб-интерфейсом для управления.

## Архитектура системы

Система состоит из 4 основных микросервисов:

### 1. **WAF Proxy** (`wafproxy/`)
- **Порт:** 8081
- **Назначение:** Основной прокси-сервер, проверяющий входящие запросы
- **Функции:**
  - Проксирование запросов к защищаемому приложению
  - Проверка запросов по сигнатурам атак
  - Блокировка malicious-запросов
  - Сбор статистики и логов

### 2. **Signature Database** (`signaturedb/`) 
- **Порт:** 8082
- **Назначение:** Хранение и управление сигнатурами атак
- **Функции:**
  - Загрузка паттернов атак в Redis
  - Поддержка различных типов атак (SQLi, XSS, Command Injection, Path Traversal)
  - API для управления сигнатурами

### 3. **Request Analyzer** (`analyzer/`)
- **Порт:** 8083
- **Назначение:** Глубокий анализ подозрительных запросов
- **Функции:**
  - Анализ эвристик и поведенческих паттернов
  - Rate limiting для защиты от DoS-атак
  - Дополнительная проверка сложных атак

### 4. **Web Admin Interface** (`waf-admin/`)
- **Порт:** 8080
- **Назначение:** Веб-интерфейс для управления и мониторинга
- **Функции:**
  - Панель управления в реальном времени
  - Настройка параметров защиты
  - Просмотр статистики и логов
  - Управление модулями защиты

### 5. **Redis** 
- **Порт:** 6379
- **Назначение:** Централизованное хранилище данных
- **Хранимые данные:**
  - Сигнатуры атак
  - Конфигурация системы
  - Статистика запросов
  - Логи безопасности

## Быстрый старт

### Требования
- Docker & Docker Compose
- 2GB+ свободной памяти

### Запуск системы

```bash
# Клонирование и запуск
git clone <repository-url>
cd Golang-Redis-WAF
docker-compose up --build

Доступ к интерфейсам
WAF Dashboard: http://localhost:8080

Защищаемое приложение: http://localhost:8081

API эндпоинты:

Статистика: http://localhost:8080/api/stats

Конфигурация: http://localhost:8080/api/config

Логи: http://localhost:8080/api/logs

Конфигурация
Настройка через веб-интерфейс
Откройте http://localhost:8080/config

Настройте параметры:

URL защищаемого приложения - целевое приложение

Порт WAF - порт прокси (по умолчанию 8081) "ПОКА НЕ РАБОТАЕТ СМЕНА"

Модули защиты - включение/выключение типов защиты

Типы защиты
SQL Injection Protection
Обнаруживает: UNION SELECT, OR 1=1, DROP TABLE, SQL комментарии

Примеры блокируемых атак:

' OR '1'='1'--

UNION SELECT * FROM users

; DROP TABLE users

XSS Protection
Обнаруживает: <script>, javascript:, event handlers

Примеры блокируемых атак:

<script>alert('XSS')</script>

javascript:alert(document.cookie)

<img src=x onerror=alert(1)>

Command Injection Protection
Обнаруживает: shell команды, pipe operators

Примеры блокируемых атак:

; whoami

| cat /etc/passwd

&& rm -rf /

Path Traversal Protection
Обнаруживает: directory traversal sequences

Примеры блокируемых атак:

../../../etc/passwd

..\..\windows\system32\

%2e%2e%2fetc%2fpasswd

Мониторинг и логи
Панель статистики
Главная панель: Обзор активности в реальном времени

Статистика: Детальная информация по типам атак

Логи: История заблокированных запросов

Метрики
Общее количество запросов

Количество заблокированных запросов

Уровень блокировки (%)

Распределение по типам угроз

IP-адреса атакующих

Логирование
Каждый заблокированный запрос логируется с:

Timestamp

IP-адрес источника

HTTP метод и URL

Обнаруженные угрозы

Действие (block/allow)

Добавление новых сигнатур
Отредактируйте signaturedb/main.go

Добавьте паттерны в соответствующие массивы:
sqlPatterns := []string{
    `ваш-регулярный-выражение`,
}

Пересоберите контейнер: docker-compose build signaturedb

